import { Directive, ElementRef } from '@angular/core';
import { fromEvent, merge, Observable } from 'rxjs';
import { map, switchMap, takeUntil, tap } from 'rxjs/operators';
import { stopPropagation } from './scrollbar/common';
export class ScrollViewport {
    constructor(viewPort) {
        this.viewPort = viewPort;
        this.nativeElement = viewPort.nativeElement;
    }
    // Get viewport size, clientHeight or clientWidth
    get clientHeight() {
        return this.nativeElement.clientHeight;
    }
    get clientWidth() {
        return this.nativeElement.clientWidth;
    }
    get scrollHeight() {
        return this.nativeElement.scrollHeight;
    }
    get scrollWidth() {
        return this.nativeElement.scrollWidth;
    }
    // Get viewport scroll offset, scrollTop or scrollLeft
    get scrollTop() {
        return this.nativeElement.scrollTop;
    }
    get scrollLeft() {
        return this.nativeElement.scrollLeft;
    }
    // Get the available scrollable size
    get scrollMaxX() {
        return this.scrollWidth - this.clientWidth;
    }
    get scrollMaxY() {
        return this.scrollHeight - this.clientHeight;
    }
    get contentHeight() {
        var _a;
        return ((_a = this.contentWrapperElement) === null || _a === void 0 ? void 0 : _a.clientHeight) || 0;
    }
    get contentWidth() {
        var _a;
        return ((_a = this.contentWrapperElement) === null || _a === void 0 ? void 0 : _a.clientWidth) || 0;
    }
    /**
     * Activate viewport pointer events such as 'hovered' and 'clicked' events
     */
    activatePointerEvents(propagate, destroyed) {
        this.hovered = new Observable((subscriber) => {
            // Stream that emits when pointer is moved over the viewport (used to set the hovered state)
            const mouseMoveStream = fromEvent(this.nativeElement, 'mousemove', { passive: true });
            const mouseMove = propagate ? mouseMoveStream : mouseMoveStream.pipe(stopPropagation());
            // Stream that emits when pointer leaves the viewport (used to remove the hovered state)
            const mouseLeave = fromEvent(this.nativeElement, 'mouseleave').pipe(map(() => false));
            merge(mouseMove, mouseLeave).pipe(tap((e) => subscriber.next(e)), takeUntil(destroyed)).subscribe();
        });
        this.clicked = new Observable((subscriber) => {
            const mouseDown = fromEvent(this.nativeElement, 'mousedown', { passive: true }).pipe(tap((e) => subscriber.next(e)));
            const mouseUp = fromEvent(this.nativeElement, 'mouseup', { passive: true }).pipe(tap(() => subscriber.next(false)));
            mouseDown.pipe(switchMap(() => mouseUp), takeUntil(destroyed)).subscribe();
        });
    }
    /**
     * Set this directive as a non-functional wrapper, called when a custom viewport is used
     */
    setAsWrapper() {
        // In this case the default viewport and the default content wrapper will act as a mask
        this.nativeElement.className = 'ng-native-scrollbar-hider ng-scroll-layer';
        if (this.nativeElement.firstElementChild) {
            this.nativeElement.firstElementChild.className = 'ng-scroll-layer';
        }
    }
    /**
     * Set this directive as  the viewport, called when no custom viewport is used
     */
    setAsViewport(customClassName) {
        this.nativeElement.className = `ng-native-scrollbar-hider ng-scroll-viewport ${customClassName}`;
        // Check if the custom viewport has only one child and set it as the content wrapper
        if (this.nativeElement.firstElementChild) {
            this.contentWrapperElement = this.nativeElement.firstElementChild;
            this.contentWrapperElement.classList.add('ng-scroll-content');
        }
    }
    /**
     * Scroll viewport vertically
     */
    scrollYTo(value) {
        this.nativeElement.scrollTop = value;
    }
    /**
     * Scroll viewport horizontally
     */
    scrollXTo(value) {
        this.nativeElement.scrollLeft = value;
    }
}
ScrollViewport.decorators = [
    { type: Directive, args: [{
                selector: '[scrollViewport]'
            },] }
];
ScrollViewport.ctorParameters = () => [
    { type: ElementRef }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLXZpZXdwb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXNjcm9sbGJhci9zcmMvbGliL3Njcm9sbC12aWV3cG9ydC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0RCxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDaEUsT0FBTyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUtyRCxNQUFNLE9BQU8sY0FBYztJQXNEekIsWUFBbUIsUUFBb0I7UUFBcEIsYUFBUSxHQUFSLFFBQVEsQ0FBWTtRQUNyQyxJQUFJLENBQUMsYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUM7SUFDOUMsQ0FBQztJQTdDRCxpREFBaUQ7SUFDakQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQztJQUN6QyxDQUFDO0lBRUQsSUFBSSxXQUFXO1FBQ2IsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQztJQUN6QyxDQUFDO0lBRUQsSUFBSSxXQUFXO1FBQ2IsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQztJQUN4QyxDQUFDO0lBRUQsc0RBQXNEO0lBQ3RELElBQUksU0FBUztRQUNYLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUM7SUFDdEMsQ0FBQztJQUVELElBQUksVUFBVTtRQUNaLE9BQU8sSUFBSSxDQUFDLGFB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SUFDSCxhQUFhLENBQUMsZUFBdUI7UUFDbkMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLEdBQUcsZ0RBQWdELGVBQWUsRUFBRSxDQUFDO1FBQ2pHLG9GQUFvRjtRQUNwRixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWlCLEVBQUU7WUFDeEMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWdDLENBQUM7WUFDakYsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsQ0FBQztTQUMvRDtJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILFNBQVMsQ0FBQyxLQUFhO1FBQ3JCLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztJQUN2QyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxTQUFTLENBQUMsS0FBYTtRQUNyQixJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7SUFDeEMsQ0FBQzs7O1lBOUhGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsa0JBQWtCO2FBQzdCOzs7WUFQbUIsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZnJvbUV2ZW50LCBtZXJnZSwgT2JzZXJ2YWJsZSwgU3Vic2NyaWJlciB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwLCBzd2l0Y2hNYXAsIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgc3RvcFByb3BhZ2F0aW9uIH0gZnJvbSAnLi9zY3JvbGxiYXIvY29tbW9uJztcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW3Njcm9sbFZpZXdwb3J0XSdcbn0pXG5leHBvcnQgY2xhc3MgU2Nyb2xsVmlld3BvcnQge1xuICAvLyBWaWV3cG9ydCBlbGVtZW50XG4gIHJlYWRvbmx5IG5hdGl2ZUVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAvLyBDb250ZW50IHdyYXBwZXIgZWxlbWVudFxuICBjb250ZW50V3JhcHBlckVsZW1lbnQhOiBIVE1MRWxlbWVudDtcblxuICAvLyBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuIHBvaW50ZXIgZXZlbnQgd2hlbiB0aGUgdmlld3BvcnQgaXMgaG92ZXJlZCBhbmQgZW1pdHMgZmFsc2UgdmFsdWUgd2hlbiBpc24ndCBob3ZlcmVkXG4gIGhvdmVyZWQhOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xuICAvLyBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuIHZpZXdwb3J0IGlzIGNsaWNrZWRcbiAgY2xpY2tlZCE6IE9ic2VydmFibGU8YW55PjtcblxuICAvLyBHZXQgdmlld3BvcnQgc2l6ZSwgY2xpZW50SGVpZ2h0IG9yIGNsaWVudFdpZHRoXG4gIGdldCBjbGllbnRIZWlnaHQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgfVxuXG4gIGdldCBjbGllbnRXaWR0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIH1cblxuICBnZXQgc2Nyb2xsSGVpZ2h0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQ7XG4gIH1cblxuICBnZXQgc2Nyb2xsV2lkdGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5uYXRpdmVFbGVtZW50LnNjcm9sbFdpZHRoO1xuICB9XG5cbiAgLy8gR2V0IHZpZXdwb3J0IHNjcm9sbCBvZmZzZXQsIHNjcm9sbFRvcCBvciBzY3JvbGxMZWZ0XG4gIGdldCBzY3JvbGxUb3AoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcDtcbiAgfVxuXG4gIGdldCBzY3JvbGxMZWZ0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xuICB9XG5cbiAgLy8gR2V0IHRoZSBhdmFpbGFibGUgc2Nyb2xsYWJsZSBzaXplXG4gIGdldCBzY3JvbGxNYXhYKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuc2Nyb2xsV2lkdGggLSB0aGlzLmNsaWVudFdpZHRoO1xuICB9XG5cbiAgZ2V0IHNjcm9sbE1heFkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxIZWlnaHQgLSB0aGlzLmNsaWVudEhlaWdodDtcbiAgfVxuXG4gIGdldCBjb250ZW50SGVpZ2h0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29udGVudFdyYXBwZXJFbGVtZW50Py5jbGllbnRIZWlnaHQgfHwgMDtcbiAgfVxuXG4gIGdldCBjb250ZW50V2lkdGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZW50V3JhcHBlckVsZW1lbnQ/LmNsaWVudFdpZHRoIHx8IDA7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgdmlld1BvcnQ6IEVsZW1lbnRSZWYpIHtcbiAgICB0aGlzLm5hdGl2ZUVsZW1lbnQgPSB2aWV3UG9ydC5uYXRpdmVFbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEFjdGl2YXRlIHZpZXdwb3J0IHBvaW50ZXIgZXZlbnRzIHN1Y2ggYXMgJ2hvdmVyZWQnIGFuZCAnY2xpY2tlZCcgZXZlbnRzXG4gICAqL1xuICBhY3RpdmF0ZVBvaW50ZXJFdmVudHMocHJvcGFnYXRlOiBib29sZWFuLCBkZXN0cm95ZWQ6IE9ic2VydmFibGU8dm9pZD4pOiB2b2lkIHtcbiAgICB0aGlzLmhvdmVyZWQgPSBuZXcgT2JzZXJ2YWJsZSgoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxib29sZWFuPikgPT4ge1xuICAgICAgLy8gU3RyZWFtIHRoYXQgZW1pdHMgd2hlbiBwb2ludGVyIGlzIG1vdmVkIG92ZXIgdGhlIHZpZXdwb3J0ICh1c2VkIHRvIHNldCB0aGUgaG92ZXJlZCBzdGF0ZSlcbiAgICAgIGNvbnN0IG1vdXNlTW92ZVN0cmVhbSA9IGZyb21FdmVudCh0aGlzLm5hdGl2ZUVsZW1lbnQsICdtb3VzZW1vdmUnLCB7IHBhc3NpdmU6IHRydWUgfSk7XG4gICAgICBjb25zdCBtb3VzZU1vdmUgPSBwcm9wYWdhdGUgPyBtb3VzZU1vdmVTdHJlYW0gOiBtb3VzZU1vdmVTdHJlYW0ucGlwZShzdG9wUHJvcGFnYXRpb24oKSk7XG4gICAgICAvLyBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuIHBvaW50ZXIgbGVhdmVzIHRoZSB2aWV3cG9ydCAodXNlZCB0byByZW1vdmUgdGhlIGhvdmVyZWQgc3RhdGUpXG4gICAgICBjb25zdCBtb3VzZUxlYXZlID0gZnJvbUV2ZW50KHRoaXMubmF0aXZlRWxlbWVudCwgJ21vdXNlbGVhdmUnKS5waXBlKG1hcCgoKSA9PiBmYWxzZSkpO1xuICAgICAgbWVyZ2UobW91c2VNb3ZlLCBtb3VzZUxlYXZlKS5waXBlKFxuICAgICAgICB0YXAoKGU6IGZhbHNlIHwgYW55KSA9PiBzdWJzY3JpYmVyLm5leHQoZSkpLFxuICAgICAgICB0YWtlVW50aWwoZGVzdHJveWVkKVxuICAgICAgKS5zdWJzY3JpYmUoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuY2xpY2tlZCA9IG5ldyBPYnNlcnZhYmxlKChzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPGFueT4pID0+IHtcbiAgICAgIGNvbnN0IG1vdXNlRG93biA9IGZyb21FdmVudCh0aGlzLm5hdGl2ZUVsZW1lbnQsICdtb3VzZWRvd24nLCB7IHBhc3NpdmU6IHRydWUgfSkucGlwZShcbiAgICAgICAgdGFwKChlOiBhbnkpID0+IHN1YnNjcmliZXIubmV4dChlKSlcbiAgICAgICk7XG4gICAgICBjb25zdCBtb3VzZVVwID0gZnJvbUV2ZW50KHRoaXMubmF0aXZlRWxlbWVudCwgJ21vdXNldXAnLCB7IHBhc3NpdmU6IHRydWUgfSkucGlwZShcbiAgICAgICAgdGFwKCgpID0+IHN1YnNjcmliZXIubmV4dChmYWxzZSkpXG4gICAgICApO1xuICAgICAgbW91c2VEb3duLnBpcGUoXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiBtb3VzZVVwKSxcbiAgICAgICAgdGFrZVVudGlsKGRlc3Ryb3llZClcbiAgICAgICkuc3Vic2NyaWJlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoaXMgZGlyZWN0aXZlIGFzIGEgbm9uLWZ1bmN0aW9uYWwgd3JhcHBlciwgY2FsbGVkIHdoZW4gYSBjdXN0b20gdmlld3BvcnQgaXMgdXNlZFxuICAgKi9cbiAgc2V0QXNXcmFwcGVyKCk6IHZvaWQge1xuICAgIC8vIEluIHRoaXMgY2FzZSB0aGUgZGVmYXVsdCB2aWV3cG9ydCBhbmQgdGhlIGRlZmF1bHQgY29udGVudCB3cmFwcGVyIHdpbGwgYWN0IGFzIGEgbWFza1xuICAgIHRoaXMubmF0aXZlRWxlbWVudC5jbGFzc05hbWUgPSAnbmctbmF0aXZlLXNjcm9sbGJhci1oaWRlciBuZy1zY3JvbGwtbGF5ZXInO1xuICAgIGlmICh0aGlzLm5hdGl2ZUVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgIHRoaXMubmF0aXZlRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc05hbWUgPSAnbmctc2Nyb2xsLWxheWVyJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoaXMgZGlyZWN0aXZlIGFzICB0aGUgdmlld3BvcnQsIGNhbGxlZCB3aGVuIG5vIGN1c3RvbSB2aWV3cG9ydCBpcyB1c2VkXG4gICAqL1xuICBzZXRBc1ZpZXdwb3J0KGN1c3RvbUNsYXNzTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5uYXRpdmVFbGVtZW50LmNsYXNzTmFtZSA9IGBuZy1uYXRpdmUtc2Nyb2xsYmFyLWhpZGVyIG5nLXNjcm9sbC12aWV3cG9ydCAke2N1c3RvbUNsYXNzTmFtZX1gO1xuICAgIC8vIENoZWNrIGlmIHRoZSBjdXN0b20gdmlld3BvcnQgaGFzIG9ubHkgb25lIGNoaWxkIGFuZCBzZXQgaXQgYXMgdGhlIGNvbnRlbnQgd3JhcHBlclxuICAgIGlmICh0aGlzLm5hdGl2ZUVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgIHRoaXMuY29udGVudFdyYXBwZXJFbGVtZW50ID0gdGhpcy5uYXRpdmVFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkIGFzIEhUTUxFbGVtZW50O1xuICAgICAgdGhpcy5jb250ZW50V3JhcHBlckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbmctc2Nyb2xsLWNvbnRlbnQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xsIHZpZXdwb3J0IHZlcnRpY2FsbHlcbiAgICovXG4gIHNjcm9sbFlUbyh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA9IHZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbCB2aWV3cG9ydCBob3Jpem9udGFsbHlcbiAgICovXG4gIHNjcm9sbFhUbyh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPSB2YWx1ZTtcbiAgfVxufVxuIl19